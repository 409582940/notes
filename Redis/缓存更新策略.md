方案：先更新数据库，再删除缓存

可能存在的问题：并发读写不一致

例：线程 A 读入 ，此时缓存没有（已经失效），去读数据库旧值 1 此时线程B 更新数据库 为 2 然后删除缓存 为 2 线程A 此时 刚读入数据库的旧值写到缓存上，造成了数据不一致的问题

这种情况其实发生概率比较小，因为要满足三个条件

1、缓存正好失效

2、读数据库和写数据库同时操作

3、更新数据库和清空缓存的时间要比读数据库写缓存的时间要短

但是发生的概率是比较低的，因为写数据库一般会加锁，这个耗时比较长

解决方法：延迟双删
就是在第一次删除之后，为了避免另一个线程的将数据库旧值更新到缓存，额外在删除一次（定时任务例如xxl-job等，时间由具体的业务决定）

还有可能存在的问题：更新数据库/或者清空缓存可能会失败

解决方案：订阅数据库变更日志（MySQL的binlog）

具体的过程：MySQL的数据发生变更，binlog会跟着变化。使用canal监听，有变化将消息发送到消息队列，然后对数据库进行删除

可能存在的问题：中间件不是百分之百可靠，消息发送，接收等都会有问题