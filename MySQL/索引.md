索引的出现就是为了解决查询效率的问题，它相当于书的目录。本身就是一种特殊的数据结构
## 索引的优点：
- 讲随机IO变成顺序IO
- 减少了需要扫描的数据量
- 帮助服务器避免排序和临时表
## 索引的缺点：
- 创建维护索引需要消耗额外的时间和空间(InnoDB上面的索引是表空间的额外组成部分)。
- 当进行增删改的操作时需要动态的维护索引，降低了效率
## 索引的用处
- 快速查找where语句的行
- 如果表中有多个索引，则优化器可以使用索引的任何最左前缀来查找行
- 当有表连接的时候，从其他表检索行数据
- 查找特定索引列min或者max值
- 如果排序或者分组在可控索引的最左前缀上完成的。则对表进行排序和分组
- 在某些情况下，可以优化查询以检索而无需查询数据行
## 索引的分类：
- 主键索引 
- 唯一索引
- 普通索引
- 全文索引

唯一索引：不允许两行有相同的值（数据列不允许重复，值可以为null，一个表可以有多个唯一索引）

主键索引：使用主键作索引（数据列不允许重复，值不能为null，一个表只能有一个主键）

聚簇索引：简单的理解就是表中的数据和索引是绑定的。表中行的物理顺序和索引的排列顺序一致

非聚簇索引：------

复合索引：在创建索引时候，不止创建一列为索引，创建多个列为索引

全文索引：全文索引在字符串数据进行复杂的查询，一般用的比较少。有相关的需要一般都是使用Elasticsearch

普通索引: 基本的索引类型，没有唯一性的限制，允许为NULL值。

![](https://raw.githubusercontent.com/409582940/notes/main/images/20220303111217.png)

## MySQL索引的数据结构

常用的数据结构一般有B+树，哈希。
B+树适合范围查找，哈希一般应用于等值查找
B+树：一种特殊的n叉树，叶子节点存储值和指向下个节点的指针，非叶子节点保存数据的指针。
### 哈希索引的限制与优势
优势：
1、哈希索引只需要存储对应的哈希值，索引的结构十分的紧凑，查找速度很快
限制：
1、哈希索引数据并不是按照索引值为顺序存储的，无法进行排序
2、哈希索引不支持部分列的匹配查找
3、哈希索引不支持范围查找
4、当哈希冲突比较多的时候，维护的成本比较高；

## InnoDB选择B+树作为默认索引的数据结构原因

可以总结为以下几点：

1、相对哈希来讲，B+树更适合范围查找。因为她增删改查的时间复杂度都是O(logn)的。

2、相对红黑树来讲。插入或者删除一个元素红黑树都需要重新平衡，这是一个额外的成本。在数据量很大的时候这个耗时会比较长，影响效率

3、相对B树来讲，B+树的查询更稳定，B+树能存储更多的数据，能减少顺序遍历而产生的额外的磁盘IO
## 索引匹配方式
- 全值匹配
全职匹配的是和索引中所有列进行匹配

- 匹配最左前缀
只匹配最前面的几列，

- 匹配列前缀
可以匹配某一列值开头的一部分

- 匹配范围值
可以查找一个范围的数据
- 精确匹配某一列或范围匹配另外一列
可以查询第一列的全部和第二列的一部分

- 只访问索引的查询 
查询的时候只访问索引，不访问数据行。本质上就是数据行

## 索引失效情况
1、组合索引不遵循最左匹配原则

2、组合索引的前面索引列使用范围查询(<,>,like),会导致后续的索引失效

3、不要在索引上做任何操作（计算，函数，类型转换）

4、is null和is not null无法使用索引

5、尽量少使用or操作符，否则连接时索引会失效

6、字符串不添加引号会导致索引失效

7、两表关联使用的条件字段中字段的长度、编码不一致会导致索引失效

8、like语句中，以%开头的模糊查询

9、如果mysql中使用全表扫描比使用索引快，也会导致索引失效